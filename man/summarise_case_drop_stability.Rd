\name{summarise_case_drop_stability}
\alias{summarise_case_drop_stability}
\title{Summarise Stability of Case-Dropping Bootstrap Correlations}
\description{
The \code{summarise_case_drop_stability} function summarizes stability metrics from case-dropping bootstraps (usually produced by \pkg{bootnet}).
It computes correlations between bootstrap estimates and the original sample estimates across decreasing sample sizes, returning average correlations, confidence intervals, and the proportion of sample retained.
This provides a concise way to evaluate the robustness of network parameters to case-dropping.
}
\usage{
summarise_case_drop_stability(
  caseDroppingBoot,
  probs = c(0.025, 0.975),
  correlation_use = "pairwise.complete.obs",
  quiet = TRUE
)
}
\arguments{
\item{\code{caseDroppingBoot}}{A list object generated by case-dropping bootstrap procedures (e.g., from \pkg{bootnet}), containing elements \code{bootTable} and \code{sampleTable}.}
\item{\code{probs}}{Numeric vector of length 2 giving the quantiles for confidence intervals of the bootstrap correlations. Default is \code{c(0.025, 0.975)}.}
\item{\code{correlation_use}}{Character. Argument passed to \code{\link[stats]{cor}} specifying how to handle missing values (e.g., \code{"pairwise.complete.obs"}, \code{"complete.obs"}). Default is \code{"pairwise.complete.obs"}.}
\item{\code{quiet}}{Logical. If \code{FALSE}, prints the first rows of the summary table for inspection. Default is \code{TRUE}.}
}
\details{
\enumerate{
\item Validates that both \code{bootTable} and \code{sampleTable} contain the required columns.
\item Extracts original estimates (from full sample size) as reference values.
\item Computes correlations between bootstrap estimates and the original values for each subsample size and statistic type.
\item Aggregates correlations by computing mean, lower, and upper quantiles of the distribution.
\item Returns a summary data frame with sample proportion, number of bootstrap replications, and stability indices.
}
}
\value{
A \code{data.frame} (tibble) with the following columns:
\itemize{
  \item{\code{type}}{Statistic type (e.g., edge weights, centrality indices).}
  \item{\code{nPerson}}{Number of cases retained in the subsample.}
  \item{\code{mean_cor}}{Mean correlation between bootstrap estimates and original values.}
  \item{\code{lo}}{Lower bound of correlation confidence interval (quantile defined by \code{probs[1]}).}
  \item{\code{hi}}{Upper bound of correlation confidence interval (quantile defined by \code{probs[2]}).}
  \item{\code{n_boot}}{Number of bootstrap replications used.}
  \item{\code{p_sampled}}{Proportion of the original sample retained (\code{nPerson / N0}).}
}
}
\examples{
\dontrun{
# Example with case-dropping bootstrap object
res <- bootnet::bootnet(myNetwork, nBoots = 200, type = "case", statistics = c("strength"))
summary_df <- summarise_case_drop_stability(res, probs = c(0.05, 0.95), quiet = FALSE)

head(summary_df)
}
}
\author{
Dr. José Ventura-León
}
